group:
  locks:
    name: Locks
    view: no
    entities:
      - lock.front_door_lock
      - sensor.front_door_lock_battery

sensor:
  - platform: template
    sensors:
      front_door_lock_battery:
        friendly_name: 'Front Door Lock Battery'
        value_template: '{{ states.zwave.front_door_lock.attributes.battery_level }}'
        unit_of_measurement: '%'
        device_class: battery

automation:
  - alias: 'Unlock sent from Harmony'
    initial_state: on
    trigger:
      - platform: event
        event_type: roku_command
        event_data:
          source_name: 'Home_Assistant'
          type: keypress
          key: 'Down'
    action:
      - service:  lock.unlock
        data:
          entity_id: lock.front_door_lock

  - alias: 'Lock sent from Harmony'
    initial_state: on
    trigger:
      - platform: event
        event_type: roku_command
        event_data:
          source_name: 'Home_Assistant'
          type: keypress
          key: 'Up'
    action:
      - service:  lock.lock
        data:
          entity_id: lock.front_door_lock

  - alias: 'Front Door Unlocked'
    initial_state: on
    trigger:
      - platform: state
        entity_id: lock.front_door_lock
        from: 'locked'
        to: 'unlocked'
    action:
      - service: notify.telegram_nathan
        data:
          title: 'Front Door Lock'
          message: 'The front door is unlocked.'
      - service: notify.telegram_erin
        data:
          title: 'Front Door Lock'
          message: 'The front door is unlocked.'
      - service: script.speech_processing
        data_template:
          speech_message: 'The front door is unlocked.'

  - alias: 'Front Door Locked'
    initial_state: on
    trigger:
      - platform: state
        entity_id: lock.front_door_lock
        from: 'unlocked'
        to: 'locked'
    action:
      - service: notify.telegram_nathan
        data:
          title: 'Front Door Lock'
          message: 'The front door is locked.'
      - service: notify.telegram_erin
        data:
          title: 'Front Door Lock'
          message: 'The front door is locked.'
      - service: script.speech_processing
        data_template:
          speech_message: 'The front door is locked.'

  - alias: 'Front Door Lock Low Battery'
    initial_state: on
    trigger:
      - platform: numeric_state
        entity_id: sensor.front_door_lock_battery
        below: 20
    action:
      - service: notify.telegram_nathan
        data:
          title: 'Front Door Lock'
          message: 'The front door lock battery is low.'
      - service: notify.telegram_erin
        data:
          title: 'Front Door Lock'
          message: 'The front door lock battery is low.'
      - service: script.speech_processing
        data_template:
          speech_message: 'The front door lock battery is low.'