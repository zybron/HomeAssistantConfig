homeassistant:
  customize:
    light.ge_14294_inwall_smart_dimmer_level:
    friendly_name:                             Living Room Switch

group:
  living_room:
    name:                                      Living Room
    entities:
      - light.ge_14294_inwall_smart_dimmer_level
      - zwave.ge_14294_inwall_smart_dimmer

input_boolean:
  vampire_mode:
    name:                                      'Vampire Mode'

sensor:
  - platform:                                  mqtt
    name:                                      'Living Room TV'
    state_topic:                               'plex/Living Room'
    value_template:                            '{{value_json.state}}'
    json_attributes:
      - user
      - full_title
      - library_name

script:
  vampire_mode_on:
    sequence:
      - service:                               light.turn_on
        data:
          entity_id:
            - light.cabinets
            - light.main_balcony
          rgb_color:                           [255,0,0]
      - service:                               light.turn_on
        data:
          entity_id:                           light.ge_14294_inwall_smart_dimmer_level
          brightness_pct:                      20
  vampire_mode_off:
    sequence:
      - service:                               light.turn_off
        data:
          entity_id:
            - light.cabinets
            - light.main_balcony
            - light.ge_14294_inwall_smart_dimmer_level

automation:
  - id:                                        MorningLightOn
    alias:                                     "Turn On Lights Daily - Morning"
    initial_state:                             on
    trigger:
    - platform:                                time
      at:                                      '07:00:00'
    action:
      - service:                               light.turn_on
        data:
          entity_id:                           light.ge_14294_inwall_smart_dimmer_level
          brightness_pct:                      100

  - id:                                        MorningLightOff
    alias:                                     "Turn Off Lights Daily - Morning"
    initial_state:                             on
    trigger:
    - platform:                                sun
      event:                                   sunrise
      offset:                                  '00:45:00'
    action:
      - service:                               light.turn_off
        entity_id:                             light.ge_14294_inwall_smart_dimmer_level

  - id:                                        EveningLightOn
    alias:                                     "Turn On Lights Daily - Evening"
    initial_state:                             on
    trigger:
    - platform:                                sun
      event:                                   sunset
      offset:                                  '-00:45:00'
    action:
      - service:                               light.turn_on
        data:
          entity_id:                           light.ge_14294_inwall_smart_dimmer_level
          brightness_pct:                      50

  - id:                                        EveningLightOffWeekday
    alias:                                     "Turn Off Lights Daily - Weekday Evening"
    initial_state:                             on
    trigger:
    - platform:                                time
      at:                                      '22:00:00'
    condition:
      condition:                               template
      value_template:                          '{{ now().weekday() < 5 }}'
    action:
      - service:                               light.turn_off
        entity_id:                             light.ge_14294_inwall_smart_dimmer_level

  - id:                                        EveningLightOffWeekend
    alias:                                     "Turn Off Lights Daily - Weekend Evening"
    initial_state:                             on
    trigger:
    - platform:                                time
      at:                                      '23:00:00'
    condition:
      condition:                               template
      value_template:                          '{{ now().weekday() == 0 or now().weekday() >= 5 }}'
    action:
      - service:                               light.turn_off
        entity_id:                             light.ge_14294_inwall_smart_dimmer_level

  - id:                                        'TurnOffLightsWhenMoviePlaying'
    alias:                                     'Turn off lights when a movie is playing'
    initial_state:                             on
    trigger:
    - platform:                                state
      entity_id:                               sensor.living_room_tv
      to:                                      'playing'
    condition:
      condition:                               and
      conditions:
        - condition:                           state
          entity_id:                           light.ge_14294_inwall_smart_dimmer_level
          state:                               'on'
        - condition:                           sun
          after:                               sunset
    action:
      - service:                               light.turn_off
        entity_id:                             light.ge_14294_inwall_smart_dimmer_level

  - id:                                        'TurnOnLightsWhenMoviePaused'
    alias:                                     'Turn on lights when a movie is paused'
    initial_state:                             on
    trigger:
    - platform:                                state
      entity_id:                               sensor.living_room_tv
      to:                                      'paused'
    condition:
      condition:                               and
      conditions:
        - condition:                           state
          entity_id:                           light.ge_14294_inwall_smart_dimmer_level
          state:                               'off'
        - condition:                           sun
          after:                               sunset
    action:
      - service:                               light.turn_on
        data:
          entity_id:                           light.ge_14294_inwall_smart_dimmer_level
          brightness_pct:                      30

  - id:                                        'VampireModeOn'
    alias:                                     'Vampire Mode On'
    initial_state:                             on
    trigger:
    - platform:                                state
      entity_id:                               input_boolean.vampire_mode
      to:                                      'on'
    action:
      - service:                               script.turn_on
        data:
          entity_id:                           script.vampire_mode_on

  - id:                                        'VampireModeOff'
    alias:                                     'Vampire Mode Off'
    initial_state:                             on
    trigger:
    - platform:                                state
      entity_id:                               input_boolean.vampire_mode
      to:                                      'off'
    action:
      - service:                               script.turn_on
        data:
          entity_id:                           script.vampire_mode_off
