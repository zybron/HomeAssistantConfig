speech_processing:
  sequence:
    - service:          script.store_message
      data_template:
        topic:          'broadcast'
        message:        '{{speech_message}}'
    - service:          tts.google_say
      entity_id:
        - media_player.kitchen_speaker
        - media_player.master_bedroom_speaker
        - media_player.dakotas_bedroom_speaker
      data_template:
        message:        '{{speech_message}}'

store_message:
  sequence:
    - service:          mqtt.publish
      data_template:
        topic:          'message/{{topic}}'
        payload:        >-
          {
            "message":"{{message}}",
            "time":"{{now().strftime("%m/%d/%Y %I:%M %p") | string}}"
          }
        retain:         true
